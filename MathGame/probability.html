<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª</title>

  <!-- Ø®Ø· Cairo -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#020617;
      --panel:#020617;
      --b:#1f2937;
      --fg:#e5e7eb;
      --muted:#a3b2c7;
      --acc:#22d3ee;
      --acc2:#6366f1;
      --good:#22c55e;
      --bad:#ef4444;
      --shadow:0 16px 40px rgba(2,6,23,.4);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(900px 600px at 15% -10%,rgba(56,189,248,.16),transparent),
        radial-gradient(900px 600px at 90% 110%,rgba(129,140,248,.16),transparent),
        var(--bg);
      color:var(--fg);
      font-family:"Cairo",system-ui,Segoe UI,Arial;
    }

    .wrap{max-width:1100px;margin:24px auto;padding:16px}
    .topbar{display:flex;justify-content:space-between;gap:12px;align-items:center;margin-bottom:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .brand h1{margin:0;font-weight:900;font-size:22px}
    .actions{display:flex;gap:8px;align-items:center}

    .btn,.btn-sm,.back{
      border:1px solid var(--b);
      background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
      color:var(--fg); padding:10px 14px; border-radius:14px; font-weight:800; cursor:pointer;
      text-decoration:none; display:inline-block;
    }
    .btn-sm{padding:8px 12px;border-radius:12px;font-size:13px}
    .btn:hover,.btn-sm:hover{filter:brightness(1.08)}
    .btn.acc{border-color:var(--acc2); box-shadow:0 0 12px rgba(129,140,248,.35)}
    .back{border-color:#f59e0b; box-shadow:0 0 12px rgba(245,158,11,.3)}

    .stage{
      background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,0));
      border:1px solid var(--b); border-radius:20px; box-shadow:var(--shadow);
      padding:18px; min-height:560px; display:grid; grid-template-rows:auto auto 1fr auto; gap:14px; overflow:hidden
    }

    .row{display:flex;align-items:center;gap:10px}
    .msg{justify-content:center;text-align:center}
    .msg.hint{color:var(--muted);font-weight:700}
    .msg.ok{color:var(--good);font-weight:900}
    .msg.bad{color:var(--bad);font-weight:900}

    .mode-main{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .mode-main .on{outline:2px solid var(--acc);}

    .pill{
      background:linear-gradient(180deg,rgba(255,255,255,.05),rgba(255,255,255,.02));
      border:1px solid var(--b);
      padding:8px 12px;
      border-radius:999px;
      font-weight:700;
      font-size:13px;
    }
    .result-row{justify-content:center;gap:8px;flex-wrap:wrap}

    .question{
      display:flex;flex-direction:column;justify-content:center;align-items:center;gap:16px;
      min-height:240px; text-align:center; font-weight:900; padding:10px;
    }

    .scenario-box{
      max-width:650px;
      border-radius:18px;
      border:1px solid rgba(148,163,184,.5);
      padding:14px 16px;
      background:radial-gradient(circle at 0 0,rgba(56,189,248,.12),transparent),
                 radial-gradient(circle at 100% 100%,rgba(52,211,153,.12),transparent),
                 rgba(15,23,42,.96);
      box-shadow:0 16px 40px rgba(15,23,42,.8);
      font-size:16px;
      line-height:1.7;
    }
    .scenario-title{
      font-size:15px;
      font-weight:800;
      color:var(--muted);
      margin-bottom:4px;
      text-align:right;
    }
    .scenario-body{
      font-size:17px;
    }

    .tag{
      display:inline-flex;
      align-items:center;
      gap:4px;
      padding:3px 9px;
      border-radius:999px;
      font-size:12px;
      background:rgba(15,23,42,.9);
      border:1px solid rgba(148,163,184,.5);
      color:var(--muted);
    }

    .options{
      display:flex; gap:12px; flex-wrap:wrap; justify-content:center; align-items:center;
    }
    .opt{
      border:none; background:none; padding:0; cursor:pointer;
    }
    .opt .box{
      min-width:140px; height:78px; border-radius:18px; border:1px solid var(--b);
      background:linear-gradient(180deg,#1d4ed8,#020617);
      color:#fff; font-weight:900; font-size:20px;
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 12px 34px rgba(0,0,0,.28);
      transition: transform .12s ease;
    }
    .opt:hover .box{ transform: translateY(-2px) }
    .opt.c2 .box{background:linear-gradient(180deg,#16a34a,#020617)}
    .opt.c3 .box{background:linear-gradient(180deg,#f59e0b,#020617)}
    .opt.c4 .box{background:linear-gradient(180deg,#9333ea,#020617)}
    .opt.c5 .box{background:linear-gradient(180deg,#06b6d4,#020617)}

    .box.small-text{font-size:18px;padding:0 8px;text-align:center;line-height:1.5}

    #confettiLayer{pointer-events:none;position:fixed;inset:0;overflow:hidden;z-index:10}

    @keyframes pop {
      0%{ transform: scale(.6); opacity:.0 }
      100%{ transform: scale(1); opacity:1 }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="10" stroke="#22d3ee" stroke-width="2"/>
          <path d="M8 12h8M12 8v8" stroke="#a78bfa" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <h1>ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª</h1>
      </div>
      <div class="actions">
        <button class="btn back" type="button" onclick="window.location.href='./index.html'">
          ğŸ”™ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        </button>
      </div>
    </div>

    <div class="stage">
      <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
      <div>
        <div class="mode-main">
          <button id="modeCert" class="btn-sm on">âœ… Ù…Ø¤ÙƒØ¯ / Ù…Ø³ØªØ­ÙŠÙ„ / Ù…Ù…ÙƒÙ†</button>
          <button id="modeOut"  class="btn-sm">ğŸ² Ø¹Ø¯Ù‘ Ø§Ù„Ù†ÙˆØ§ØªØ¬</button>
          <button id="modeMore" class="btn-sm">âš– Ø£ÙŠÙ‡Ù…Ø§ Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§ØŸ</button>
          <button id="modeFrac" class="btn-sm">ğŸ“Š Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ ÙƒÙƒØ³Ø±</button>
          <button id="btnNew"   class="btn-sm acc">ğŸ”„ Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</button>
          <button id="btnVoice" class="btn-sm" onclick="toggleVoice()">ğŸ”ˆ ØµÙˆØª: ÙŠØ¹Ù…Ù„</button>
        </div>
      </div>

      <!-- Ø±Ø³Ø§Ù„Ø© -->
      <div id="message" class="row msg hint">
        Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„ØŒ Ø«Ù… Ø¬Ø§ÙˆØ¨ ÙˆØ§ÙƒØªØ´Ù Ø£ÙŠÙ‘ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§ ÙŠØ§ Ø¨Ø·Ù„ ğŸ²
      </div>

      <!-- Ø§Ù„Ø³Ø¤Ø§Ù„ -->
      <div id="questionArea" class="question"></div>

      <!-- Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª -->
      <div id="options" class="options"></div>

      <!-- Ù†ØªØ§Ø¦Ø¬ -->
      <div class="row result-row">
        <div class="pill">Ù…Ø­Ø§ÙˆÙ„Ø§Øª: <span id="tries">0</span></div>
        <div class="pill">Ø³Ù„Ø³Ù„Ø© ØµØ­ÙŠØ­Ø©: <span id="streak">0</span></div>
        <div class="pill">Ø£ÙØ¶Ù„ Ø³Ù„Ø³Ù„Ø©: <span id="best">0</span></div>
      </div>

      <div id="confettiLayer"></div>
    </div>
  </div>

  <script>
    /************ Ø­Ø§Ù„Ø© Ø¹Ø§Ù…Ø© ************/
    let mode = 'certainty'; // certainty | outcomes | morelikely | fraction
    let currentAnswer = null;
    let tries = 0, streak = 0, best = 0;

    const msgEl   = document.getElementById('message');
    const qArea   = document.getElementById('questionArea');
    const optsEl  = document.getElementById('options');

    const triesEl  = document.getElementById('tries');
    const streakEl = document.getElementById('streak');
    const bestEl   = document.getElementById('best');

    const btnNew   = document.getElementById('btnNew');
    const btnVoice = document.getElementById('btnVoice');
    const modeCert = document.getElementById('modeCert');
    const modeOut  = document.getElementById('modeOut');
    const modeMore = document.getElementById('modeMore');
    const modeFrac = document.getElementById('modeFrac');

    function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }
    function pick(arr){ return arr[Math.floor(Math.random()*(arr.length))+0]; }
    function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]];} return a; }
    function colorClass(i){ return ['c1','c2','c3','c4','c5'][i%5]; }

    /************ ØµÙˆØª (Ø¨Ø¯ÙˆÙ† Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¥ÙŠÙ…ÙˆØ¬ÙŠ) ************/
    let voiceOn = true;
    let __arVoice = null;
    function __pickArabicVoice(){
      const voices = window.speechSynthesis?.getVoices?.() || [];
      return voices.find(v => v.lang?.toLowerCase().startsWith('ar'))
          || voices.find(v => /ar|sa|eg|ma|ae|jo|tn/i.test(v.lang||'')) || null;
    }
    function __stripEmojiAndSymbols(s){
      let t = String(s);
      t = t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g, '');
      t = t.replace(/[\u200D\uFE0F]/g, '');
      t = t.replace(/[^ \u0600-\u06FF0-9\.\!\?ØŒØŸ\-]/g, '');
      t = t.replace(/^[^\u0600-\u06FF0-9]+/, '');
      t = t.replace(/\s{2,}/g, ' ').trim();
      return t;
    }
    function __voiceTune(u, tone){
      if(tone === 'ok'){ u.rate = 1.05; u.pitch = 1.05; u.volume = 1.0; }
      else if(tone === 'bad'){ u.rate = 0.95; u.pitch = 0.9; u.volume = 0.95; }
    }
    function speak(msg, tone){
      try{
        if(!voiceOn || !window.speechSynthesis) return;
        const t = __stripEmojiAndSymbols(msg);
        if(!t) return;
        const u = new SpeechSynthesisUtterance(t);
        u.lang = 'ar';
        if(!__arVoice){
          __arVoice = __pickArabicVoice();
          if(!__arVoice){
            window.speechSynthesis.onvoiceschanged = () => { __arVoice = __pickArabicVoice(); };
          }
        }
        if(__arVoice) u.voice = __arVoice;
        __voiceTune(u, tone);
        window.speechSynthesis.cancel();
        window.speechSynthesis.speak(u);
      }catch(e){}
    }
    function toggleVoice(){
      voiceOn = !voiceOn;
      btnVoice.textContent = voiceOn ? 'ğŸ”ˆ ØµÙˆØª: ÙŠØ¹Ù…Ù„' : 'ğŸ”‡ ØµÙˆØª: Ù…ØªÙˆÙ‚Ù';
    }

    function playSuccess(){ try{ new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_84e61fce5c.mp3").play(); }catch(e){} }
    function playError(){ try{ const a=new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_1b7a1c4f8a.mp3"); a.volume=.8; a.play(); }catch(e){} }

    function confettiOnce(){
      const layer = document.getElementById('confettiLayer');
      for(let i=0;i<18;i++){
        const c = document.createElement('i');
        c.style.position='fixed';
        c.style.left = Math.random()*100 + '%';
        c.style.top  = '-20px';
        c.style.width='8px'; c.style.height='14px';
        c.style.background=`hsl(${Math.random()*360},90%,60%)`;
        c.style.borderRadius='2px';
        c.style.transform=`rotate(${Math.random()*180}deg)`;
        c.style.opacity='0.9';
        c.style.transition='transform 2s linear, top 2s linear, opacity 2.1s ease-out';
        layer.appendChild(c);
        const endTop = 100 + Math.random()*20;
        requestAnimationFrame(()=>{
          c.style.top = endTop+'vh';
          c.style.transform = `rotate(${360+Math.random()*180}deg)`;
          c.style.opacity='0.1';
        });
        setTimeout(()=>c.remove(), 2300+Math.random()*400);
      }
    }

    /************ ØªÙˆÙ„ÙŠØ¯ Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù…Ø¹ ØªÙ†ÙˆÙŠØ¹ ÙÙŠ Ø§Ù„ØµÙŠØºØ© ************/

    // 1) Ù…Ø¤ÙƒØ¯ / Ù…Ø³ØªØ­ÙŠÙ„ / Ù…Ù…ÙƒÙ†
    function makeCertaintyQuestion(){
      const kind = pick(['bag','die','coin','week']);

      if(kind === 'bag'){
        let red = randInt(0,5);
        let blue = randInt(0,5);
        if(red === 0 && blue === 0){
          red = 1;
        }
        const colorAsk = pick(['Ø­Ù…Ø±Ø§Ø¡','Ø²Ø±Ù‚Ø§Ø¡']);
        const countAsk = colorAsk === 'Ø­Ù…Ø±Ø§Ø¡' ? red : blue;
        const countOther = colorAsk === 'Ø­Ù…Ø±Ø§Ø¡' ? blue : red;

        let answer;
        if(countAsk === 0){
          answer = 'Ù…Ø³ØªØ­ÙŠÙ„';
        }else if(countOther === 0){
          answer = 'Ù…Ø¤ÙƒØ¯';
        }else{
          answer = 'Ù…Ù…ÙƒÙ†';
        }

        const text = `ÙÙŠ ÙƒÙŠØ³ ÙƒØ±Ø§ØªØŒ ÙŠÙˆØ¬Ø¯ ${red} ÙƒØ±Ø§Øª Ø­Ù…Ø±Ø§Ø¡ Ùˆ${blue} ÙƒØ±Ø§Øª Ø²Ø±Ù‚Ø§Ø¡. Ù†Ø±ÙŠØ¯ Ø³Ø­Ø¨ ÙƒØ±Ø© ${colorAsk}. Ù‡Ù„ Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¯Ø« Ù…Ø¤ÙƒØ¯ Ø£Ù… Ù…Ø³ØªØ­ÙŠÙ„ Ø£Ù… Ù…Ù…ÙƒÙ† Ø§Ù„Ø­Ø¯ÙˆØ«ØŸ`;

        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø³Ø­Ø¨ ÙƒØ±Ø© Ù…Ù† ÙƒÙŠØ³',
          text,
          answer,
          options:['Ù…Ø¤ÙƒØ¯','Ù…Ø³ØªØ­ÙŠÙ„','Ù…Ù…ÙƒÙ†']
        };
      }

      if(kind === 'die'){
        const faces = 6;
        const sub = pick(['greater','inrange','even','odd']);
        let text, answer;

        if(sub === 'greater'){
          text = `Ù„Ø¯ÙŠÙ†Ø§ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${faces}. Ù†Ø±Ù…ÙŠ Ø§Ù„Ù…ÙƒØ¹Ø¨ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ÙŠØ¸Ù‡Ø± Ø¹Ø¯Ø¯ Ø£ÙƒØ¨Ø± Ù…Ù† ${faces}ØŸ`;
          answer = 'Ù…Ø³ØªØ­ÙŠÙ„';
        }else if(sub === 'inrange'){
          text = `Ù„Ø¯ÙŠÙ†Ø§ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${faces}. Ù†Ø±Ù…ÙŠ Ø§Ù„Ù…ÙƒØ¹Ø¨ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ø¤ÙƒØ¯ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø¸Ø§Ù‡Ø± Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${faces}ØŸ`;
          answer = 'Ù…Ø¤ÙƒØ¯';
        }else if(sub === 'even'){
          text = `Ù„Ø¯ÙŠÙ†Ø§ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${faces}. Ù†Ø±Ù…ÙŠ Ø§Ù„Ù…ÙƒØ¹Ø¨ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ÙŠØ¸Ù‡Ø± Ø¹Ø¯Ø¯ Ø²ÙˆØ¬ÙŠØŸ`;
          answer = 'Ù…Ù…ÙƒÙ†';
        }else{
          text = `Ù„Ø¯ÙŠÙ†Ø§ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${faces}. Ù†Ø±Ù…ÙŠ Ø§Ù„Ù…ÙƒØ¹Ø¨ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ÙŠØ¸Ù‡Ø± Ø¹Ø¯Ø¯ ÙØ±Ø¯ÙŠØŸ`;
          answer = 'Ù…Ù…ÙƒÙ†';
        }

        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø±Ù…ÙŠ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯',
          text,
          answer,
          options:['Ù…Ø¤ÙƒØ¯','Ù…Ø³ØªØ­ÙŠÙ„','Ù…Ù…ÙƒÙ†']
        };
      }

      if(kind === 'coin'){
        const sub = pick(['image','twoTimes','edge']);
        let text, answer;

        if(sub === 'image'){
          text = 'Ù†Ø±Ù…ÙŠ Ù‚Ø·Ø¹Ø© Ù†Ù‚Ø¯ Ø¹Ù„ÙŠÙ‡Ø§ ØµÙˆØ±Ø© ÙˆÙƒØªØ§Ø¨Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ØªØ¸Ù‡Ø± Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø±Ù…ÙŠØŸ';
          answer = 'Ù…Ù…ÙƒÙ†';
        }else if(sub === 'twoTimes'){
          text = 'Ù†Ø±Ù…ÙŠ Ù‚Ø·Ø¹Ø© Ù†Ù‚Ø¯ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ø¤ÙƒØ¯ Ø£Ù† ØªØ¸Ù‡Ø± Ø§Ù„ØµÙˆØ±Ø© Ù…Ø±ØªÙŠÙ†ØŸ';
          answer = 'Ù…Ø³ØªØ­ÙŠÙ„';
        }else{
          text = 'Ù†Ø±Ù…ÙŠ Ù‚Ø·Ø¹Ø© Ù†Ù‚Ø¯. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ØªØ³ØªÙ‚Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© ÙˆØ§Ù‚ÙØ© Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ© (ØºÙŠØ± ØµÙˆØ±Ø© ÙˆÙ„Ø§ ÙƒØªØ§Ø¨Ø©)ØŸ';
          answer = 'Ù…Ø³ØªØ­ÙŠÙ„';
        }

        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø±Ù…ÙŠ Ù‚Ø·Ø¹Ø© Ù†Ù‚Ø¯',
          text,
          answer,
          options:['Ù…Ø¤ÙƒØ¯','Ù…Ø³ØªØ­ÙŠÙ„','Ù…Ù…ÙƒÙ†']
        };
      }

      // week
      const sub = pick(['week-sure','week-weekend']);
      let text, answer;
      if(sub === 'week-sure'){
        text = 'Ø§Ø®ØªØ§Ø±Øª Ù†Ø¯Ù‰ ÙŠÙˆÙ…Ù‹Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø¨Ø¹Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ø¤ÙƒØ¯ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø®ØªØ§Ø± Ø£Ø­Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ØŸ';
        answer = 'Ù…Ø¤ÙƒØ¯';
      }else{
        text = 'Ø§Ø®ØªØ§Ø±Øª Ù†Ø¯Ù‰ ÙŠÙˆÙ…Ù‹Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø¨Ø¹Ø©. Ù‡Ù„ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø®ØªØ§Ø± ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø©ØŸ';
        answer = 'Ù…Ù…ÙƒÙ†';
      }

      return {
        title:'ØªØ¬Ø±Ø¨Ø©: Ø§Ø®ØªÙŠØ§Ø± ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
        text,
        answer,
        options:['Ù…Ø¤ÙƒØ¯','Ù…Ø³ØªØ­ÙŠÙ„','Ù…Ù…ÙƒÙ†']
      };
    }

    /************ 2) Ø¹Ø¯Ù‘ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© â€” 10 ØµÙŠØº Ù…ØªÙ†ÙˆØ¹Ø© ************/
    function makeOutcomesQuestion(){
      const scenario = randInt(1,10);

      // 1) Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ø­Ø¯
      if(scenario === 1){
        const faces = randInt(4,10);
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø±Ù…ÙŠ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ø­Ø¯',
          text:`Ù„Ø¯ÙŠÙ†Ø§ Ù…ÙƒØ¹Ø¨ Ø£Ø¹Ø¯Ø§Ø¯ Ù…ÙƒØªÙˆØ¨ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${faces}. Ù†Ø±Ù…ÙŠ Ø§Ù„Ù…ÙƒØ¹Ø¨ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©ØŸ`,
          answer:String(faces),
          choices: makeChoicesAround(faces,4)
        };
      }

      // 2) Ø¯ÙˆÙ‘Ø§Ø±Ø© Ø£Ù„ÙˆØ§Ù†
      if(scenario === 2){
        const sections = randInt(3,8);
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø¯ÙˆÙ‘Ø§Ø±Ø© Ø£Ù„ÙˆØ§Ù†',
          text:`Ù„Ø¯ÙŠÙ†Ø§ Ø¯ÙˆÙ‘Ø§Ø±Ø© Ù…Ù‚Ø³Ù‘Ù…Ø© Ø¥Ù„Ù‰ ${sections} Ø£Ù‚Ø³Ø§Ù… Ø¨Ø£Ù„ÙˆØ§Ù† Ù…Ø®ØªÙ„ÙØ©. Ø¹Ù†Ø¯ Ø¯ÙˆØ±Ø§Ù†Ù‡Ø§ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ø¹Ù„Ù‰ ÙƒÙ… Ø§Ø­ØªÙ…Ø§Ù„ Ù…Ø®ØªÙ„Ù ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙ‚Ø¹ Ø§Ù„Ø³Ù‡Ù…ØŸ`,
          answer:String(sections),
          choices: makeChoicesAround(sections,4)
        };
      }

      // 3) Ø§Ø®ØªÙŠØ§Ø± Ø­Ø±Ù Ù…Ù† ÙƒÙ„Ù…Ø©
      if(scenario === 3){
        const words = ['Ø±ÙŠØ§Ø¶ÙŠØ§Øª','Ù…Ø¯Ø±Ø³Ø©','Ø·Ø§Ù„Ø¨','Ù…Ø¹Ù„Ù‘Ù…','Ù…Ø³Ø§Ø¡','Ù†Ø¬Ø§Ø­','ØµØ¯Ø§Ù‚Ø©'];
        const w = pick(words);
        const n = w.length;
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø§Ø®ØªÙŠØ§Ø± Ø­Ø±Ù Ù…Ù† ÙƒÙ„Ù…Ø©',
          text:`Ø§Ø®ØªØ§Ø±Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø­Ø±ÙÙ‹Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø§Ù„ÙƒÙ„Ù…Ø© (${w}). Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„ØªØ¬Ø±Ø¨Ø©ØŸ`,
          answer:String(n),
          choices: makeChoicesAround(n,4)
        };
      }

      // 4) Ø§Ø®ØªÙŠØ§Ø± ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
      if(scenario === 4){
        // Ø¯Ø§ÙŠÙ…Ù‹Ø§ 7 Ù„ÙƒÙ† Ø§Ù„Ø·Ø§Ù„Ø¨ ÙŠØªØ¯Ø±Ù‘Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙÙƒØ±Ø©
        const correct = 7;
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø§Ø®ØªÙŠØ§Ø± ÙŠÙˆÙ… Ù…Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹',
          text:'Ø§Ø®ØªØ§Ø± Ø³Ø§Ù…Ø± ÙŠÙˆÙ…Ù‹Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ø£ÙŠØ§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡ØŸ',
          answer:String(correct),
          choices: makeChoicesAround(correct,4)
        };
      }

      // 5) Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù… Ù…Ù† 0 Ø¥Ù„Ù‰ 9
      if(scenario === 5){
        const correct = 10;
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø§Ø®ØªÙŠØ§Ø± Ø±Ù‚Ù…',
          text:'ÙÙŠ ÙƒÙŠØ³ Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø±Ù‚Ù‘Ù…Ø© Ù…Ù† Ù  Ø¥Ù„Ù‰ Ù©. Ø³ÙØ­Ø¨Øª Ø¨Ø·Ø§Ù‚Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©ØŸ',
          answer:String(correct),
          choices: makeChoicesAround(correct,4)
        };
      }

      // 6) Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù„Ø¨ Ù…Ù† ÙØµÙ„
      if(scenario === 6){
        const students = randInt(15,35);
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù„Ø¨ Ù…Ù† Ø§Ù„ÙØµÙ„',
          text:`ÙÙŠ ÙØµÙ„ Ø¯Ø±Ø§Ø³ÙŠ ÙŠÙˆØ¬Ø¯ ${students} Ø·Ø§Ù„Ø¨Ù‹Ø§. Ø§Ø®ØªØ§Ø±Øª Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø·Ø§Ù„Ø¨Ù‹Ø§ ÙˆØ§Ø­Ø¯Ù‹Ø§ Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©ØŸ`,
          answer:String(students),
          choices: makeChoicesAround(students,4)
        };
      }

      // 7) Ø³Ø­Ø¨ Ø¨Ø·Ø§Ù‚Ø© Ù…Ù† Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø±Ù‚Ù‘Ù…Ø©
      if(scenario === 7){
        const maxNum = randInt(5,12);
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø³Ø­Ø¨ Ø¨Ø·Ø§Ù‚Ø© Ù…Ø±Ù‚Ù‘Ù…Ø©',
          text:`Ù„Ø¯ÙŠÙ†Ø§ Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ø±Ù‚Ù‘Ù…Ø© Ù…Ù† Ù¡ Ø¥Ù„Ù‰ ${maxNum} Ù…ÙˆØ¶ÙˆØ¹Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©ØŒ ØªÙ… Ø³Ø­Ø¨ Ø¨Ø·Ø§Ù‚Ø© ÙˆØ§Ø­Ø¯Ø©. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©ØŸ`,
          answer:String(maxNum),
          choices: makeChoicesAround(maxNum,4)
        };
      }

      // 8) Ø±Ù…ÙŠ Ù‚Ø·Ø¹ØªÙŠÙ† Ù†Ù‚Ø¯ÙŠØªÙŠÙ† (ØµÙˆØ±Ø©/ÙƒØªØ§Ø¨Ø©)
      if(scenario === 8){
        const correct = 4; // (ØµÙˆØ±Ø©,ØµÙˆØ±Ø©) (ØµÙˆØ±Ø©,ÙƒØªØ§Ø¨Ø©) (ÙƒØªØ§Ø¨Ø©,ØµÙˆØ±Ø©) (ÙƒØªØ§Ø¨Ø©,ÙƒØªØ§Ø¨Ø©)
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø±Ù…ÙŠ Ù‚Ø·Ø¹ØªÙŠÙ† Ù†Ù‚Ø¯ÙŠØªÙŠÙ†',
          text:'ØªÙ… Ø±Ù…ÙŠ Ù‚Ø·Ø¹ØªÙŠÙ† Ù†Ù‚Ø¯ÙŠØªÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚Øª. ÙƒÙ„ Ù‚Ø·Ø¹Ø© Ù„Ù‡Ø§ ØµÙˆØ±Ø© Ø£Ùˆ ÙƒØªØ§Ø¨Ø©. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØµÙˆØ±ØªÙŠÙ†/Ø§Ù„ÙƒØªØ§Ø¨ØªÙŠÙ†ØŸ',
          answer:String(correct),
          choices: makeChoicesAround(correct,4)
        };
      }

      // 9) Ø±Ù…ÙŠ Ù…ÙƒØ¹Ø¨ÙŠÙ† ÙˆØ¬Ù…Ø¹ Ø§Ù„Ù†Ø§ØªØ¬
      if(scenario === 9){
        // Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù…ÙƒØ¹Ø¨ÙŠÙ† Ù…Ù† 1 Ø¥Ù„Ù‰ 6 = 11 (Ù…Ù† 2 Ø¥Ù„Ù‰ 12)
        const correct = 11;
        return {
          title:'ØªØ¬Ø±Ø¨Ø©: Ø±Ù…ÙŠ Ù…ÙƒØ¹Ø¨ÙŠÙ† Ø«Ù… Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ø¯Ø¯ÙŠÙ†',
          text:'ØªÙ… Ø±Ù…ÙŠ Ù…ÙƒØ¹Ø¨ÙŠ Ø£Ø¹Ø¯Ø§Ø¯ (Ù¡ Ø¥Ù„Ù‰ Ù¦) Ø«Ù… Ø¬Ù…Ø¹ Ø§Ù„Ø¹Ø¯Ø¯ÙŠÙ† Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠÙ†. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø®ØªÙ„ÙØ© Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¹Ø¯Ø¯ÙŠÙ†ØŸ',
          answer:String(correct),
          choices: makeChoicesAround(correct,4)
        };
      }

      // 10) Ø§Ø®ØªÙŠØ§Ø± Ù„ÙˆÙ† Ù…Ù† ÙƒØ±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
      const colorsCount = randInt(3,6);
      return {
        title:'ØªØ¬Ø±Ø¨Ø©: Ø§Ø®ØªÙŠØ§Ø± Ù„ÙˆÙ† Ù…Ù† ÙƒØ±Ø§Øª',
        text:`ÙÙŠ ØµÙ†Ø¯ÙˆÙ‚ ØªÙˆØ¬Ø¯ ÙƒØ±Ø§Øª Ø¨Ù€ ${colorsCount} Ø£Ù„ÙˆØ§Ù† Ù…Ø®ØªÙ„ÙØ©. Ø³ÙØ­Ø¨Øª ÙƒØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§. Ù…Ø§ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù…Ù† Ù†Ø§Ø­ÙŠØ© Ø§Ù„Ù„ÙˆÙ†ØŸ`,
        answer:String(colorsCount),
        choices: makeChoicesAround(colorsCount,4)
      };
    }

    function makeChoicesAround(correct, count){
      const set = new Set([correct]);
      while(set.size < count){
        let delta = pick([-3,-2,-1,1,2,3]);
        let cand = correct + delta;
        if(cand < 1) cand = 1;
        set.add(cand);
      }
      return shuffle([...set]);
    }

    /************ 3) Ø£ÙŠÙ‡Ù…Ø§ Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§ØŸ ************/
    function makeMoreLikelyQuestion(){
      const type = pick(['bag','spinner']);

      if(type === 'bag'){
        let red = randInt(1,6);
        let blue = randInt(1,6);
        const equalChance = Math.random() < 0.35;
        if(equalChance){
          const v = randInt(1,6);
          red = v;
          blue = v;
        }else{
          while(red === blue){
            red = randInt(1,6);
            blue = randInt(1,6);
          }
        }

        let answer;
        if(red > blue) answer = 'Ø­Ù…Ø±Ø§Ø¡';
        else if(blue > red) answer = 'Ø²Ø±Ù‚Ø§Ø¡';
        else answer = 'Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†';

        const text = `ÙÙŠ ÙƒÙŠØ³ ÙƒØ±Ø§ØªØŒ ÙŠÙˆØ¬Ø¯ ${red} ÙƒØ±Ø§Øª Ø­Ù…Ø±Ø§Ø¡ Ùˆ${blue} ÙƒØ±Ø§Øª Ø²Ø±Ù‚Ø§Ø¡. Ø¹Ù†Ø¯ Ø³Ø­Ø¨ ÙƒØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ØŒ Ø£ÙŠÙ‘Ù‡Ù…Ø§ Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§: Ø³Ø­Ø¨ ÙƒØ±Ø© Ø­Ù…Ø±Ø§Ø¡ Ø£Ù… Ø²Ø±Ù‚Ø§Ø¡ØŒ Ø£Ù… Ø£Ù†Ù‡Ù…Ø§ Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†ØŸ`;

        return {
          title:'Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ø­ØªÙ…Ø§Ù„ Ø³Ø­Ø¨ ÙƒØ±Ø© Ù…Ù† ÙƒÙŠØ³',
          text,
          answer,
          options:['Ø­Ù…Ø±Ø§Ø¡','Ø²Ø±Ù‚Ø§Ø¡','Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†']
        };
      }

      // spinner
      let blue = randInt(1,5);
      let yellow = randInt(1,5);
      const equalChance2 = Math.random() < 0.3;
      if(equalChance2){
        const v = randInt(1,5);
        blue = v;
        yellow = v;
      }else{
        while(blue === yellow){
          blue = randInt(1,5);
          yellow = randInt(1,5);
        }
      }

      let answer2;
      if(blue > yellow) answer2 = 'Ø£Ø²Ø±Ù‚';
      else if(yellow > blue) answer2 = 'Ø£ØµÙØ±';
      else answer2 = 'Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†';

      const text2 = `Ù„Ø¯ÙŠÙ†Ø§ Ø¯ÙˆÙ‘Ø§Ø±Ø© Ù…Ù‚Ø³Ù‘Ù…Ø© Ø¥Ù„Ù‰ Ø£Ø¬Ø²Ø§Ø¡: ${blue} Ø¬Ø²Ø¡ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø²Ø±Ù‚ Ùˆ${yellow} Ø¬Ø²Ø¡ Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ØµÙØ±. Ø¹Ù†Ø¯ Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ø¯ÙˆÙ‘Ø§Ø±Ø© Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø©ØŒ Ø£ÙŠÙ‘ Ù„ÙˆÙ† Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§ Ø£Ù† ÙŠÙ‚Ø¹ Ø¹Ù„ÙŠÙ‡ Ø§Ù„Ø³Ù‡Ù…ØŒ Ø£Ù… Ø£Ù† Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ Ù…ØªØ³Ø§ÙˆÙØŸ`;

      return {
        title:'Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ø­ØªÙ…Ø§Ù„ Ø¯ÙˆÙ‘Ø§Ø±Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù†',
        text:text2,
        answer:answer2,
        options:['Ø£Ø²Ø±Ù‚','Ø£ØµÙØ±','Ù…ØªØ³Ø§ÙˆÙŠØ§Ù†']
      };
    }

    /************ 4) Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ ÙƒÙƒØ³Ø± ************/
    function makeFractionProbQuestion(){
      const context = pick(['balls','pens','cards']);
      const total = randInt(3,10);
      const target = randInt(1,total-1);
      const other = total - target;

      let thingTarget, thingOther, title;
      if(context === 'balls'){
        title = 'ÙƒÙŠØ³ ÙƒØ±Ø§Øª Ù…Ù„ÙˆÙ‘Ù†Ø©';
        thingTarget = 'Ø­Ù…Ø±Ø§Ø¡';
        thingOther  = 'Ø²Ø±Ù‚Ø§Ø¡';
      }else if(context === 'pens'){
        title = 'Ø¹Ù„Ø¨Ø© Ø£Ù‚Ù„Ø§Ù…';
        thingTarget = 'Ø­Ù…Ø±Ø§Ø¡';
        thingOther  = 'Ø²Ø±Ù‚Ø§Ø¡';
      }else{
        title = 'Ø¨Ø·Ø§Ù‚Ø§Øª Ù…Ù„ÙˆÙ‘Ù†Ø©';
        thingTarget = 'Ø­Ù…Ø±Ø§Ø¡';
        thingOther  = 'Ø®Ø¶Ø±Ø§Ø¡';
      }

      const answer = `${target}/${total}`;
      const text = `Ù„Ø¯ÙŠÙ†Ø§ ${title}: ÙŠÙˆØ¬Ø¯ ${target} ${context === 'cards' ? 'Ø¨Ø·Ø§Ù‚Ø§Øª' : 'Ù‚Ø·Ø¹'} ${thingTarget} Ùˆ${other} ${thingOther}. Ù…Ø§ Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± ${context === 'pens' ? 'Ù‚Ù„Ù…' : 'ÙˆØ§Ø­Ø¯Ø©'} ${thingTarget} Ø¹Ø´ÙˆØ§Ø¦ÙŠÙ‹Ø§ØŸ Ø¹Ø¨Ù‘Ø± Ø¹Ù† Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ Ø¹Ù„Ù‰ ØµÙˆØ±Ø© ÙƒØ³Ø±.`;

      const choices = makeFractionChoices(target,total,4);

      return {
        title:'Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ Ø¹Ù„Ù‰ ØµÙˆØ±Ø© ÙƒØ³Ø±',
        text,
        answer,
        choices
      };
    }

    function makeFractionChoices(num,den,count){
      const set = new Set([`${num}/${den}`]);
      while(set.size < count){
        let n = num + pick([-2,-1,1,2]);
        let d = den + pick([-2,-1,1,2]);
        if(n < 1) n = 1;
        if(d <= 1) d = 2;
        if(n > d) [n,d] = [d,n];
        set.add(`${n}/${d}`);
      }
      return shuffle([...set]);
    }

    /************ Ø±Ø³Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø­Ø³Ø¨ Ø§Ù„Ù†Ù…Ø· ************/

    function renderCertainty(){
      const sc = makeCertaintyQuestion();
      currentAnswer = sc.answer;

      qArea.innerHTML = `
        <div class="scenario-box">
          <div class="scenario-title">${sc.title}</div>
          <div class="scenario-body">${sc.text}</div>
        </div>
        <div class="tag">Ù‡Ù„ Ø§Ù„Ø­Ø¯Ø« Ù…Ø¤ÙƒØ¯ Ø£Ù… Ù…Ø³ØªØ­ÙŠÙ„ Ø£Ù… Ù…Ù…ÙƒÙ† Ø§Ù„Ø­Ø¯ÙˆØ«ØŸ</div>
      `;

      optsEl.innerHTML = '';
      const arr = shuffle([...sc.options]);
      arr.forEach((txt,i)=>{
        const btn = document.createElement('button');
        btn.className = `opt ${colorClass(i)}`;
        btn.innerHTML = `<div class="box small-text">${txt}</div>`;
        btn.onclick = ()=>onPick(txt,btn);
        optsEl.appendChild(btn);
      });

      msgEl.className='row msg hint';
      msgEl.textContent='Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…ÙˆÙ‚Ù Ø¬ÙŠØ¯Ù‹Ø§ Ø«Ù… Ø­Ø¯Ù‘Ø¯ Ù‡Ù„ Ø§Ù„Ø­Ø¯Ø« Ù…Ø¤ÙƒØ¯ Ø£Ùˆ Ù…Ø³ØªØ­ÙŠÙ„ Ø£Ùˆ Ù…Ù…ÙƒÙ†. ğŸ¤”';
    }

    function renderOutcomes(){
      const sc = makeOutcomesQuestion();
      currentAnswer = sc.answer;

      qArea.innerHTML = `
        <div class="scenario-box">
          <div class="scenario-title">${sc.title}</div>
          <div class="scenario-body">${sc.text}</div>
        </div>
        <div class="tag">ØªØ°ÙƒÙ‘Ø±: Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© = Ø¬Ù…ÙŠØ¹ Ù…Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ­Ø¯Ø« ÙÙŠ Ø§Ù„ØªØ¬Ø±Ø¨Ø©.</div>
      `;

      optsEl.innerHTML = '';
      const arr = shuffle([...sc.choices]);
      arr.forEach((num,i)=>{
        const txt = String(num);
        const btn = document.createElement('button');
        btn.className = `opt ${colorClass(i)}`;
        btn.innerHTML = `<div class="box">${txt}</div>`;
        btn.onclick = ()=>onPick(txt,btn);
        optsEl.appendChild(btn);
      });

      msgEl.className='row msg hint';
      msgEl.textContent='Ø¹Ø¯Ù‘ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø©ØŒ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØµØ­ÙŠØ­.';
    }

    function renderMoreLikely(){
      const sc = makeMoreLikelyQuestion();
      currentAnswer = sc.answer;

      qArea.innerHTML = `
        <div class="scenario-box">
          <div class="scenario-title">${sc.title}</div>
          <div class="scenario-body">${sc.text}</div>
        </div>
        <div class="tag">Ù‚Ø§Ø±Ù† Ø¨ÙŠÙ† Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ù„ÙƒÙ„ Ø­Ø¯Ø« Ù„ØªØ¹Ø±Ù Ø£ÙŠÙ‘Ù‡Ù…Ø§ Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§.</div>
      `;

      optsEl.innerHTML = '';
      const arr = shuffle([...sc.options]);
      arr.forEach((txt,i)=>{
        const btn = document.createElement('button');
        btn.className = `opt ${colorClass(i)}`;
        btn.innerHTML = `<div class="box small-text">${txt}</div>`;
        btn.onclick = ()=>onPick(txt,btn);
        optsEl.appendChild(btn);
      });

      msgEl.className='row msg hint';
      msgEl.textContent='Ø§Ù†Ø¸Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¯ØŒ Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø­Ø¯Ø« Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§ Ø£Ùˆ Ø§Ù„Ù…ØªØ³Ø§ÙˆÙŠ.';
    }

    function renderFractionProb(){
      const sc = makeFractionProbQuestion();
      currentAnswer = sc.answer;

      qArea.innerHTML = `
        <div class="scenario-box">
          <div class="scenario-title">${sc.title}</div>
          <div class="scenario-body">${sc.text}</div>
        </div>
        <div class="tag">Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ = Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© / Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„ÙƒÙ„ÙŠ.</div>
      `;

      optsEl.innerHTML = '';
      const arr = shuffle([...sc.choices]);
      arr.forEach((txt,i)=>{
        const btn = document.createElement('button');
        btn.className = `opt ${colorClass(i)}`;
        btn.innerHTML = `<div class="box">${txt}</div>`;
        btn.onclick = ()=>onPick(txt,btn);
        optsEl.appendChild(btn);
      });

      msgEl.className='row msg hint';
      msgEl.textContent='Ø­ÙˆÙ‘Ù„ Ø§Ù„Ù…ÙˆÙ‚Ù Ø¥Ù„Ù‰ ÙƒØ³Ø±: (Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©) / (ÙƒÙ„ Ø§Ù„Ù†ÙˆØ§ØªØ¬).';
    }

    function render(){
      if(mode==='certainty') renderCertainty();
      else if(mode==='outcomes') renderOutcomes();
      else if(mode==='morelikely') renderMoreLikely();
      else renderFractionProb();
    }

    function newQuestion(){
      render();
    }
    btnNew.onclick = newQuestion;

    /************ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø·Ø§Ù„Ø¨ ************/
    function onPick(value, btn){
      tries++; triesEl.textContent = tries.toString();

      if(String(value)===String(currentAnswer)){
        streak++; if(streak>best){best=streak; bestEl.textContent=best.toString();}
        streakEl.textContent = streak.toString();

        msgEl.className='row msg ok';
        let text;
        if(mode==='certainty') text = 'Ù…Ù…ØªØ§Ø²! ÙØ±Ù‘Ù‚Øª Ø¨ÙŠÙ† Ø§Ù„Ù…Ø¤ÙƒØ¯ ÙˆØ§Ù„Ù…Ø³ØªØ­ÙŠÙ„ ÙˆØ§Ù„Ù…Ù…ÙƒÙ† ğŸ‘';
        else if(mode==='outcomes') text = 'Ø±Ø§Ø¦Ø¹! Ø¹Ø¯Ù‘ÙŠØª Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­ ğŸ²';
        else if(mode==='morelikely') text = 'Ø£Ø­Ø³Ù†Øª! Ø¹Ø±ÙØª Ø§Ù„Ø­Ø¯Ø« Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§ âš–ï¸';
        else text = 'Ø´Ø§Ø·Ø±! ÙƒØªØ¨Øª Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ Ø¹Ù„Ù‰ ØµÙˆØ±Ø© ÙƒØ³Ø± ØµØ­ÙŠØ­ ğŸ“Š';

        msgEl.textContent = text;
        speak(text,'ok');
        playSuccess();
        confettiOnce();

        const box = btn.querySelector('.box');
        box.style.transform='scale(1.05)';
        setTimeout(()=>{
          box.style.transform='';
          newQuestion();
        },700);
      }else{
        streak=0; streakEl.textContent='0';
        msgEl.className='row msg bad';
        const text = 'Ù‚Ø±ÙŠØ¨Ø© Ø¬Ø¯Ù‹Ø§! ÙÙƒÙ‘Ø± ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ù Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø«Ù… Ø¬Ø±Ù‘Ø¨ Ù…Ù† Ø¬Ø¯ÙŠØ¯ ğŸ˜Š';
        msgEl.textContent = text;
        speak(text,'bad');
        playError();

        const box = btn.querySelector('.box');
        box.style.transform='scale(0.94)';
        setTimeout(()=>{ box.style.transform=''; },160);
      }
    }

    /************ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ************/
    function setMode(newMode){
      mode = newMode;
      [modeCert,modeOut,modeMore,modeFrac].forEach(b=>b.classList.remove('on'));
      if(mode==='certainty') modeCert.classList.add('on');
      else if(mode==='outcomes') modeOut.classList.add('on');
      else if(mode==='morelikely') modeMore.classList.add('on');
      else modeFrac.classList.add('on');

      if(mode==='certainty'){
        msgEl.textContent = 'Ø­Ø¯Ù‘Ø¯ Ù‡Ù„ Ø§Ù„Ø­Ø¯Ø« Ù…Ø¤ÙƒØ¯ Ø£Ùˆ Ù…Ø³ØªØ­ÙŠÙ„ Ø£Ùˆ Ù…Ù…ÙƒÙ† Ø§Ù„Ø­Ø¯ÙˆØ«.';
      }else if(mode==='outcomes'){
        msgEl.textContent = 'Ø¹Ø¯Ù‘ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ù…ÙƒÙ†Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø© Ø«Ù… Ø§Ø®ØªØ± Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ØµØ­ÙŠØ­.';
      }else if(mode==='morelikely'){
        msgEl.textContent = 'Ù‚Ø§Ø±Ù† Ø¨ÙŠÙ† Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„ØªØ¹Ø±Ù Ø£ÙŠÙ‘Ù‡Ø§ Ø£ÙƒØ«Ø± Ø§Ø­ØªÙ…Ø§Ù„Ù‹Ø§.';
      }else{
        msgEl.textContent = 'Ø­ÙˆÙ‘Ù„ Ø§Ù„Ù…ÙˆÙ‚Ù Ø¥Ù„Ù‰ ÙƒØ³Ø±: Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø¹Ù„Ù‰ Ø¹Ø¯Ø¯ Ø§Ù„Ù†ÙˆØ§ØªØ¬ Ø§Ù„ÙƒÙ„ÙŠØ©.';
      }
      msgEl.className='row msg hint';
      newQuestion();
    }

    modeCert.onclick = ()=>setMode('certainty');
    modeOut.onclick  = ()=>setMode('outcomes');
    modeMore.onclick = ()=>setMode('morelikely');
    modeFrac.onclick = ()=>setMode('fraction');

    // Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„
    newQuestion();
  </script>
</body>
</html>
